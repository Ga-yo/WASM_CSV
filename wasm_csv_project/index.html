<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style>
    /*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */
    @layer properties;
    @layer theme, base, components, utilities;

    @layer theme {

      :root,
      :host {
        --font-sans: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
          'Noto Color Emoji';
        --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',
          monospace;
        --color-neutral-50: oklch(98.5% 0 0);
        --color-neutral-100: oklch(97% 0 0);
        --color-neutral-200: oklch(92.2% 0 0);
        --color-neutral-300: oklch(87% 0 0);
        --color-neutral-400: oklch(70.8% 0 0);
        --color-neutral-500: oklch(55.6% 0 0);
        --color-neutral-600: oklch(43.9% 0 0);
        --color-neutral-700: oklch(37.1% 0 0);
        --color-neutral-800: oklch(26.9% 0 0);
        --color-neutral-900: oklch(20.5% 0 0);
        --color-white: #fff;
        --spacing: 0.25rem;
        --text-xs: 0.75rem;
        --text-xs--line-height: calc(1 / 0.75);
        --text-sm: 0.875rem;
        --text-sm--line-height: calc(1.25 / 0.875);
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --tracking-wide: 0.025em;
        --radius-md: 0.375rem;
        --radius-lg: 0.5rem;
        --radius-xl: 0.75rem;
        --default-transition-duration: 150ms;
        --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        --default-font-family: var(--font-sans);
        --default-mono-font-family: var(--font-mono);
      }
    }

    @layer base {

      *,
      ::after,
      ::before,
      ::backdrop,
      ::file-selector-button {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        border: 0 solid;
      }

      html,
      :host {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        tab-size: 4;
        font-family: var(--default-font-family, ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji');
        font-feature-settings: var(--default-font-feature-settings, normal);
        font-variation-settings: var(--default-font-variation-settings, normal);
        -webkit-tap-highlight-color: transparent;
      }

      hr {
        height: 0;
        color: inherit;
        border-top-width: 1px;
      }

      abbr:where([title]) {
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      a {
        color: inherit;
        -webkit-text-decoration: inherit;
        text-decoration: inherit;
      }

      b,
      strong {
        font-weight: bolder;
      }

      code,
      kbd,
      samp,
      pre {
        font-family: var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace);
        font-feature-settings: var(--default-mono-font-feature-settings, normal);
        font-variation-settings: var(--default-mono-font-variation-settings, normal);
        font-size: 1em;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      table {
        text-indent: 0;
        border-color: inherit;
        border-collapse: collapse;
      }

      :-moz-focusring {
        outline: auto;
      }

      progress {
        vertical-align: baseline;
      }

      summary {
        display: list-item;
      }

      ol,
      ul,
      menu {
        list-style: none;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      button,
      input,
      select,
      optgroup,
      textarea,
      ::file-selector-button {
        font: inherit;
        font-feature-settings: inherit;
        font-variation-settings: inherit;
        letter-spacing: inherit;
        color: inherit;
        border-radius: 0;
        background-color: transparent;
        opacity: 1;
      }

      :where(select:is([multiple], [size])) optgroup {
        font-weight: bolder;
      }

      :where(select:is([multiple], [size])) optgroup option {
        padding-inline-start: 20px;
      }

      ::file-selector-button {
        margin-inline-end: 4px;
      }

      ::placeholder {
        opacity: 1;
      }

      @supports (not (-webkit-appearance: -apple-pay-button)) or (contain-intrinsic-size: 1px) {
        ::placeholder {
          color: currentcolor;

          @supports (color: color-mix(in lab, red, red)) {
            color: color-mix(in oklab, currentcolor 50%, transparent);
          }
        }
      }

      textarea {
        resize: vertical;
      }

      ::-webkit-search-decoration {
        -webkit-appearance: none;
      }

      ::-webkit-date-and-time-value {
        min-height: 1lh;
        text-align: inherit;
      }

      ::-webkit-datetime-edit {
        display: inline-flex;
      }

      ::-webkit-datetime-edit-fields-wrapper {
        padding: 0;
      }

      ::-webkit-datetime-edit,
      ::-webkit-datetime-edit-year-field,
      ::-webkit-datetime-edit-month-field,
      ::-webkit-datetime-edit-day-field,
      ::-webkit-datetime-edit-hour-field,
      ::-webkit-datetime-edit-minute-field,
      ::-webkit-datetime-edit-second-field,
      ::-webkit-datetime-edit-millisecond-field,
      ::-webkit-datetime-edit-meridiem-field {
        padding-block: 0;
      }

      ::-webkit-calendar-picker-indicator {
        line-height: 1;
      }

      :-moz-ui-invalid {
        box-shadow: none;
      }

      button,
      input:where([type='button'], [type='reset'], [type='submit']),
      ::file-selector-button {
        appearance: button;
      }

      ::-webkit-inner-spin-button,
      ::-webkit-outer-spin-button {
        height: auto;
      }

      [hidden]:where(:not([hidden='until-found'])) {
        display: none !important;
      }
    }

    @layer utilities {
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip-path: inset(50%);
        white-space: nowrap;
        border-width: 0;
      }

      .absolute {
        position: absolute;
      }

      .relative {
        position: relative;
      }

      .sticky {
        position: sticky;
      }

      .top-0 {
        top: calc(var(--spacing) * 0);
      }

      .top-1\/2 {
        top: calc(1/2 * 100%);
      }

      .top-16 {
        top: calc(var(--spacing) * 16);
      }

      .bottom-0 {
        bottom: calc(var(--spacing) * 0);
      }

      .left-3 {
        left: calc(var(--spacing) * 3);
      }

      .z-30 {
        z-index: 30;
      }

      .col-span-2 {
        grid-column: span 2 / span 2;
      }

      .col-span-3 {
        grid-column: span 3 / span 3;
      }

      .col-span-6 {
        grid-column: span 6 / span 6;
      }

      .col-span-9 {
        grid-column: span 12 / span 12;
      }

      .mx-6 {
        margin-inline: calc(var(--spacing) * 6);
      }

      .mx-8 {
        margin-inline: calc(var(--spacing) * 8);
      }

      .mx-auto {
        margin-inline: auto;
      }

      .mt-1 {
        margin-top: calc(var(--spacing) * 1);
      }

      .mt-2 {
        margin-top: calc(var(--spacing) * 2);
      }

      .mt-3 {
        margin-top: calc(var(--spacing) * 3);
      }

      .mt-4 {
        margin-top: calc(var(--spacing) * 4);
      }

      .mt-5 {
        margin-top: calc(var(--spacing) * 5);
      }

      .mt-6 {
        margin-top: calc(var(--spacing) * 6);
      }

      .mr-2 {
        margin-right: calc(var(--spacing) * 2);
      }

      .mb-3 {
        margin-bottom: calc(var(--spacing) * 3);
      }

      .mb-6 {
        margin-bottom: calc(var(--spacing) * 6);
      }

      .flex {
        display: flex;
      }

      .grid {
        display: grid;
      }

      .inline-flex {
        display: inline-flex;
      }

      .h-2 {
        height: calc(var(--spacing) * 2);
      }

      .h-6 {
        height: calc(var(--spacing) * 6);
      }

      .h-7 {
        height: calc(var(--spacing) * 7);
      }

      .h-8 {
        height: calc(var(--spacing) * 8);
      }

      .h-9 {
        height: calc(var(--spacing) * 9);
      }

      .h-10 {
        height: calc(var(--spacing) * 10);
      }

      .h-11 {
        height: calc(var(--spacing) * 11);
      }

      .h-12 {
        height: calc(var(--spacing) * 12);
      }

      .h-16 {
        height: calc(var(--spacing) * 16);
      }

      .h-full {
        height: 100%;
      }

      .min-h-\[1024px\] {
        min-height: 1024px;
      }

      .min-h-screen {
        min-height: 100vh;
      }

      .w-2\/3 {
        width: calc(2/3 * 100%);
      }

      .w-8 {
        width: calc(var(--spacing) * 8);
      }

      .w-9 {
        width: calc(var(--spacing) * 9);
      }

      .w-12 {
        width: calc(var(--spacing) * 12);
      }

      .w-\[1440px\] {
        width: 1440px;
      }

      .w-full {
        width: 100%;
      }

      .w-px {
        width: 1px;
      }

      .max-w-\[720px\] {
        max-width: 720px;
      }

      .flex-1 {
        flex: 1;
      }

      .-translate-y-1\/2 {
        --tw-translate-y: calc(calc(1/2 * 100%) * -1);
        translate: var(--tw-translate-x) var(--tw-translate-y);
      }

      .cursor-pointer {
        cursor: pointer;
      }

      .grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .grid-cols-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }

      .grid-cols-12 {
        grid-template-columns: repeat(12, minmax(0, 1fr));
      }

      .flex-col {
        flex-direction: column;
      }

      .items-center {
        align-items: center;
      }

      .items-start {
        align-items: flex-start;
      }

      .justify-between {
        justify-content: space-between;
      }

      .justify-center {
        justify-content: center;
      }

      .gap-2 {
        gap: calc(var(--spacing) * 2);
      }

      .gap-3 {
        gap: calc(var(--spacing) * 3);
      }

      .gap-4 {
        gap: calc(var(--spacing) * 4);
      }

      .gap-6 {
        gap: calc(var(--spacing) * 6);
      }

      .space-y-2 {
        :where(& > :not(:last-child)) {
          --tw-space-y-reverse: 0;
          margin-block-start: calc(calc(var(--spacing) * 2) * var(--tw-space-y-reverse));
          margin-block-end: calc(calc(var(--spacing) * 2) * calc(1 - var(--tw-space-y-reverse)));
        }
      }

      .space-y-3 {
        :where(& > :not(:last-child)) {
          --tw-space-y-reverse: 0;
          margin-block-start: calc(calc(var(--spacing) * 3) * var(--tw-space-y-reverse));
          margin-block-end: calc(calc(var(--spacing) * 3) * calc(1 - var(--tw-space-y-reverse)));
        }
      }

      .divide-y {
        :where(& > :not(:last-child)) {
          --tw-divide-y-reverse: 0;
          border-bottom-style: var(--tw-border-style);
          border-top-style: var(--tw-border-style);
          border-top-width: calc(1px * var(--tw-divide-y-reverse));
          border-bottom-width: calc(1px * calc(1 - var(--tw-divide-y-reverse)));
        }
      }

      .divide-neutral-200 {
        :where(& > :not(:last-child)) {
          border-color: var(--color-neutral-200);
        }
      }

      .overflow-hidden {
        overflow: hidden;
      }

      .rounded-full {
        border-radius: calc(infinity * 1px);
      }

      .rounded-lg {
        border-radius: var(--radius-lg);
      }

      .rounded-md {
        border-radius: var(--radius-md);
      }

      .rounded-xl {
        border-radius: var(--radius-xl);
      }

      .border {
        border-style: var(--tw-border-style);
        border-width: 1px;
      }

      .border-2 {
        border-style: var(--tw-border-style);
        border-width: 2px;
      }

      .border-t {
        border-top-style: var(--tw-border-style);
        border-top-width: 1px;
      }

      .border-b {
        border-bottom-style: var(--tw-border-style);
        border-bottom-width: 1px;
      }

      .border-dashed {
        --tw-border-style: dashed;
        border-style: dashed;
      }

      .border-neutral-200 {
        border-color: var(--color-neutral-200);
      }

      .border-neutral-300 {
        border-color: var(--color-neutral-300);
      }

      .bg-neutral-50 {
        background-color: var(--color-neutral-50);
      }

      .bg-neutral-100 {
        background-color: var(--color-neutral-100);
      }

      .bg-neutral-200 {
        background-color: var(--color-neutral-200);
      }

      .bg-neutral-800 {
        background-color: var(--color-neutral-800);
      }

      .bg-neutral-900 {
        background-color: var(--color-neutral-900);
      }

      .bg-white {
        background-color: var(--color-white);
      }

      .p-2 {
        padding: calc(var(--spacing) * 2);
      }

      .p-4 {
        padding: calc(var(--spacing) * 4);
      }

      .p-5 {
        padding: calc(var(--spacing) * 5);
      }

      .p-6 {
        padding: calc(var(--spacing) * 6);
      }

      .p-10 {
        padding: calc(var(--spacing) * 10);
      }

      .px-2 {
        padding-inline: calc(var(--spacing) * 2);
      }

      .px-3 {
        padding-inline: calc(var(--spacing) * 3);
      }

      .px-4 {
        padding-inline: calc(var(--spacing) * 4);
      }

      .px-5 {
        padding-inline: calc(var(--spacing) * 5);
      }

      .px-6 {
        padding-inline: calc(var(--spacing) * 6);
      }

      .py-2 {
        padding-block: calc(var(--spacing) * 2);
      }

      .py-4 {
        padding-block: calc(var(--spacing) * 4);
      }

      .py-6 {
        padding-block: calc(var(--spacing) * 6);
      }

      .pr-3 {
        padding-right: calc(var(--spacing) * 3);
      }

      .pl-10 {
        padding-left: calc(var(--spacing) * 10);
      }

      .text-center {
        text-align: center;
      }

      .text-sm {
        font-size: var(--text-sm);
        line-height: var(--tw-leading, var(--text-sm--line-height));
      }

      .text-xs {
        font-size: var(--text-xs);
        line-height: var(--tw-leading, var(--text-xs--line-height));
      }

      .text-\[11px\] {
        font-size: 11px;
      }

      .text-\[15px\] {
        font-size: 15px;
      }

      .text-\[22px\] {
        font-size: 22px;
      }

      .font-medium {
        --tw-font-weight: var(--font-weight-medium);
        font-weight: var(--font-weight-medium);
      }

      .font-semibold {
        --tw-font-weight: var(--font-weight-semibold);
        font-weight: var(--font-weight-semibold);
      }

      .tracking-\[-0\.01em\] {
        --tw-tracking: -0.01em;
        letter-spacing: -0.01em;
      }

      .tracking-wide {
        --tw-tracking: var(--tracking-wide);
        letter-spacing: var(--tracking-wide);
      }

      .text-neutral-400 {
        color: var(--color-neutral-400);
      }

      .text-neutral-500 {
        color: var(--color-neutral-500);
      }

      .text-neutral-600 {
        color: var(--color-neutral-600);
      }

      .text-neutral-700 {
        color: var(--color-neutral-700);
      }

      .text-neutral-800 {
        color: var(--color-neutral-800);
      }

      .text-neutral-900 {
        color: var(--color-neutral-900);
      }

      .text-white {
        color: var(--color-white);
      }

      .uppercase {
        text-transform: uppercase;
      }

      .placeholder-neutral-400 {
        &::placeholder {
          color: var(--color-neutral-400);
        }
      }

      .shadow-sm {
        --tw-shadow: 0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)), 0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));
        box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
      }

      .transition-opacity {
        transition-property: opacity;
        transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));
        transition-duration: var(--tw-duration, var(--default-transition-duration));
      }

      .hover\:bg-neutral-50 {
        &:hover {
          @media (hover: hover) {
            background-color: var(--color-neutral-50);
          }
        }
      }

      .hover\:bg-neutral-100 {
        &:hover {
          @media (hover: hover) {
            background-color: var(--color-neutral-100);
          }
        }
      }

      .hover\:underline {
        &:hover {
          @media (hover: hover) {
            text-decoration-line: underline;
          }
        }
      }

      .hover\:opacity-90 {
        &:hover {
          @media (hover: hover) {
            opacity: 90%;
          }
        }
      }

      .focus\:ring-2 {
        &:focus {
          --tw-ring-shadow: var(--tw-ring-inset, ) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);
          box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
        }
      }

      .focus\:ring-neutral-300 {
        &:focus {
          --tw-ring-color: var(--color-neutral-300);
        }
      }

      .focus\:outline-none {
        &:focus {
          --tw-outline-style: none;
          outline-style: none;
        }
      }
    }

    @property --tw-translate-x {
      syntax: "*";
      inherits: false;
      initial-value: 0;
    }

    @property --tw-translate-y {
      syntax: "*";
      inherits: false;
      initial-value: 0;
    }

    @property --tw-translate-z {
      syntax: "*";
      inherits: false;
      initial-value: 0;
    }

    @property --tw-space-y-reverse {
      syntax: "*";
      inherits: false;
      initial-value: 0;
    }

    @property --tw-divide-y-reverse {
      syntax: "*";
      inherits: false;
      initial-value: 0;
    }

    @property --tw-border-style {
      syntax: "*";
      inherits: false;
      initial-value: solid;
    }

    @property --tw-font-weight {
      syntax: "*";
      inherits: false;
    }

    @property --tw-tracking {
      syntax: "*";
      inherits: false;
    }

    @property --tw-shadow {
      syntax: "*";
      inherits: false;
      initial-value: 0 0 #0000;
    }

    @property --tw-shadow-color {
      syntax: "*";
      inherits: false;
    }

    @property --tw-shadow-alpha {
      syntax: "<percentage>";
      inherits: false;
      initial-value: 100%;
    }

    @property --tw-inset-shadow {
      syntax: "*";
      inherits: false;
      initial-value: 0 0 #0000;
    }

    @property --tw-inset-shadow-color {
      syntax: "*";
      inherits: false;
    }

    @property --tw-inset-shadow-alpha {
      syntax: "<percentage>";
      inherits: false;
      initial-value: 100%;
    }

    @property --tw-ring-color {
      syntax: "*";
      inherits: false;
    }

    @property --tw-ring-shadow {
      syntax: "*";
      inherits: false;
      initial-value: 0 0 #0000;
    }

    @property --tw-inset-ring-color {
      syntax: "*";
      inherits: false;
    }

    @property --tw-inset-ring-shadow {
      syntax: "*";
      inherits: false;
      initial-value: 0 0 #0000;
    }

    @property --tw-ring-inset {
      syntax: "*";
      inherits: false;
    }

    @property --tw-ring-offset-width {
      syntax: "<length>";
      inherits: false;
      initial-value: 0px;
    }

    @property --tw-ring-offset-color {
      syntax: "*";
      inherits: false;
      initial-value: #fff;
    }

    @property --tw-ring-offset-shadow {
      syntax: "*";
      inherits: false;
      initial-value: 0 0 #0000;
    }

    @layer properties {
      @supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))) {

        *,
        ::before,
        ::after,
        ::backdrop {
          --tw-translate-x: 0;
          --tw-translate-y: 0;
          --tw-translate-z: 0;
          --tw-space-y-reverse: 0;
          --tw-divide-y-reverse: 0;
          --tw-border-style: solid;
          --tw-font-weight: initial;
          --tw-tracking: initial;
          --tw-shadow: 0 0 #0000;
          --tw-shadow-color: initial;
          --tw-shadow-alpha: 100%;
          --tw-inset-shadow: 0 0 #0000;
          --tw-inset-shadow-color: initial;
          --tw-inset-shadow-alpha: 100%;
          --tw-ring-color: initial;
          --tw-ring-shadow: 0 0 #0000;
          --tw-inset-ring-color: initial;
          --tw-inset-ring-shadow: 0 0 #0000;
          --tw-ring-inset: initial;
          --tw-ring-offset-width: 0px;
          --tw-ring-offset-color: #fff;
          --tw-ring-offset-shadow: 0 0 #0000;
        }
      }
    }
  </style>
  <style>
    html {
      font-family: 'Pretendard', sans-serif;
    }
  </style>
</head>


<body style="overscroll-behavior-x: auto;">
  <div class="ui-screen">
    <div id="canvas" class="min-h-screen w-full bg-neutral-100 py-6">
      <div id="app-frame"
        class="relative mx-auto w-[1440px] min-h-[1024px] bg-white border border-neutral-200 shadow-sm rounded-xl overflow-hidden">


        <div id="content" class="px-6 py-6 grid grid-cols-12 gap-6">


          <main id="main" class="col-span-9">
            <section id="hero-upload" class="border border-neutral-200 rounded-xl bg-neutral-50">
              <div class="p-6 flex items-start justify-between">
                <div>
                  <div class="text-[22px] font-semibold text-neutral-900 tracking-[-0.01em]">데이터 분석 시작하기</div>
                  <div class="mt-1 text-neutral-600">CSV 파일을 업로드하여 빠르게 탐색하고 시각화하세요.</div>
                </div>
              </div>
              <div id="dropzone" class="mx-6 mb-6 rounded-lg border-2 border-dashed border-neutral-300 bg-white">
                <div class="p-10 flex flex-col items-center justify-center text-center">
                  <div class="h-12 w-12 rounded-md bg-neutral-900 flex items-center justify-center">
                    <i class="fa-solid fa-table text-white"></i>
                  </div>
                  <div class="mt-4 text-neutral-900 font-medium">CSV 파일을 이곳에 드래그 앤 드롭</div>
                  <div class="mt-1 text-sm text-neutral-600">또는 아래 버튼으로 파일을 선택하세요 (최대 50MB)</div>
                  <input id="file-input" type="file" accept=".csv" class="sr-only">
                  <label for="file-input"
                    class="mt-5 inline-flex items-center justify-center h-11 px-4 rounded-md border border-neutral-200 text-sm text-neutral-800 hover:bg-neutral-100 cursor-pointer">
                    <i class="fa-regular fa-file-lines mr-2"></i>파일 선택
                  </label>
                  <div id="selected-file-info" class="mt-3 flex items-center gap-2">
                    <span id="selected-file-text" class="text-sm text-neutral-600">선택된 파일 없음</span>
                    <button id="btn-remove-file" class="hidden h-6 px-2 rounded text-xs text-neutral-500 hover:text-neutral-800 hover:bg-neutral-100">
                      <i class="fa-solid fa-xmark"></i> 제거
                    </button>
                  </div>
                  <div id="upload-notes" class="mt-2 text-xs text-neutral-500">UTF-8 인코딩 권장, 구분자 자동 감지</div>
                </div>
              </div>
            </section>


            <section id="quick-actions" class="mt-6">
              <div class="flex items-center justify-between mb-3">
                <div class="text-sm font-medium text-neutral-900">빠른 작업</div>
              </div>
              <div class="grid grid-cols-3 gap-4">
                <div id="card-quick-stats"
                  class="border border-neutral-200 rounded-lg bg-white p-4 hover:bg-neutral-50">
                  <div class="flex items-center justify-between">
                    <div class="text-neutral-900 font-medium">요약 통계</div>
                    <i class="fa-solid fa-chart-simple text-neutral-600"></i>
                  </div>
                  <div class="mt-2 text-sm text-neutral-600">최솟값, 최댓값, 평균, 필터</div>
                  <button id="btn-show-stats" class="mt-4 h-10 w-full rounded-md bg-neutral-900 text-white text-sm disabled:bg-neutral-300 disabled:cursor-not-allowed" disabled>실행</button>
                </div>

                <div id="card-quick-viz" class="border border-neutral-200 rounded-lg bg-white p-4 hover:bg-neutral-50">
                  <div class="flex items-center justify-between">
                    <div class="text-neutral-900 font-medium">데이터 시각화</div>
                    <i class="fa-solid fa-chart-bar text-neutral-600"></i>
                  </div>
                  <div class="mt-2 text-sm text-neutral-600">막대, 원형, 선 그래프</div>
                  <button id="btn-show-data" class="mt-4 h-10 w-full rounded-md border border-neutral-200 text-sm text-neutral-800 hover:bg-neutral-100 disabled:bg-neutral-100 disabled:text-neutral-400 disabled:cursor-not-allowed" disabled>보기</button>
                </div>

                <div id="card-download" class="border border-neutral-200 rounded-lg bg-white p-4 hover:bg-neutral-50">
                  <div class="flex items-center justify-between">
                    <div class="text-neutral-900 font-medium">JSON 다운로드</div>
                    <i class="fa-solid fa-download text-neutral-600"></i>
                  </div>
                  <div class="mt-2 text-sm text-neutral-600">JSON 파일로 저장</div>
                  <button id="btn-download-json-main" class="mt-4 h-10 w-full rounded-md border border-neutral-200 text-sm text-neutral-800 hover:bg-neutral-100 disabled:bg-neutral-100 disabled:text-neutral-400 disabled:cursor-not-allowed" disabled>다운로드</button>
                </div>
              </div>
            </section>



          </main>
        </div>
      </div>
    </div>
  </div>

  <!-- Stats Modal -->
  <div id="stats-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50">
    <div class="bg-white rounded-xl w-[90%] max-w-4xl max-h-[80vh] flex flex-col">
      <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
        <div class="text-lg font-semibold text-neutral-900">요약 통계</div>
        <button id="btn-close-stats-modal" class="h-8 w-8 rounded hover:bg-neutral-100 flex items-center justify-center">
          <i class="fa-solid fa-xmark text-neutral-600"></i>
        </button>
      </div>
      <div class="p-4 border-b border-neutral-200">
        <div class="flex items-center gap-4 text-sm">
          <span class="text-neutral-600">타입 필터:</span>
          <label class="flex items-center gap-1">
            <input type="checkbox" class="type-filter" value="all" checked>
            <span>전체</span>
          </label>
          <label class="flex items-center gap-1">
            <input type="checkbox" class="type-filter" value="숫자">
            <span>숫자</span>
          </label>
          <label class="flex items-center gap-1">
            <input type="checkbox" class="type-filter" value="문자">
            <span>문자</span>
          </label>
        </div>
      </div>
      <div class="flex-1 overflow-auto p-4">
        <table id="stats-table" class="w-full text-sm">
          <thead>
            <tr class="border-b border-neutral-200">
              <th data-sort="column" class="text-left p-2 cursor-pointer hover:bg-neutral-50">컬럼 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="type" class="text-left p-2 cursor-pointer hover:bg-neutral-50">타입 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="count" class="text-right p-2 cursor-pointer hover:bg-neutral-50">개수 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="unique" class="text-right p-2 cursor-pointer hover:bg-neutral-50">고유값 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="min" class="text-right p-2 cursor-pointer hover:bg-neutral-50">최솟값 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="max" class="text-right p-2 cursor-pointer hover:bg-neutral-50">최댓값 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
              <th data-sort="avg" class="text-right p-2 cursor-pointer hover:bg-neutral-50">평균 <i class="fa-solid fa-sort text-neutral-400 ml-1"></i></th>
            </tr>
          </thead>
          <tbody id="stats-table-body">
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Data Modal -->
  <div id="data-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50">
    <div class="bg-white rounded-xl w-[95%] max-w-6xl max-h-[85vh] flex flex-col">
      <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
        <div class="text-lg font-semibold text-neutral-900">데이터 시각화</div>
        <button id="btn-close-data-modal" class="h-8 w-8 rounded hover:bg-neutral-100 flex items-center justify-center">
          <i class="fa-solid fa-xmark text-neutral-600"></i>
        </button>
      </div>
      <div class="p-4 border-b border-neutral-200 flex items-center gap-4">
        <input id="data-search" type="text" placeholder="검색..." class="h-9 px-3 rounded-md border border-neutral-200 text-sm flex-1">
        <div class="flex items-center gap-2 text-sm text-neutral-600">
          <span>페이지당:</span>
          <select id="page-size" class="h-9 px-2 rounded-md border border-neutral-200">
            <option value="10">10</option>
            <option value="20" selected>20</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>
      </div>
      <div class="flex-1 overflow-auto">
        <table id="data-table" class="w-full text-sm">
          <thead id="data-table-head" class="sticky top-0 bg-white">
          </thead>
          <tbody id="data-table-body">
          </tbody>
        </table>
      </div>
      <div class="p-4 border-t border-neutral-200 flex items-center justify-between">
        <div id="data-info" class="text-sm text-neutral-600"></div>
        <div class="flex items-center gap-2">
          <button id="btn-prev-page" class="h-8 px-3 rounded border border-neutral-200 text-sm hover:bg-neutral-100 disabled:opacity-50 disabled:cursor-not-allowed">이전</button>
          <span id="page-info" class="text-sm text-neutral-600"></span>
          <button id="btn-next-page" class="h-8 px-3 rounded border border-neutral-200 text-sm hover:bg-neutral-100 disabled:opacity-50 disabled:cursor-not-allowed">다음</button>
        </div>
      </div>
    </div>
  </div>

  <script src="csv_converter.js"></script>
  <script>
    let convertedJson = null;
    let jsonData = null;
    let currentFilename = '';

    // Statistics table state
    let statsData = [];
    let statsSortKey = null;
    let statsSortAsc = true;
    let statsTypeFilter = 'all';

    // Data table state
    let currentPage = 1;
    let pageSize = 20;
    let filteredData = [];
    let allData = [];
    let allHeaders = [];

    // Wait for WASM module to load
    var Module = {
      onRuntimeInitialized: function () {
        console.log('WASM module loaded');
        initializeApp();
      }
    };

    function initializeApp() {
      const fileInput = document.getElementById('file-input');
      const dropzone = document.getElementById('dropzone');

      // File input change handler
      fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          processFile(file);
        }
      });

      // Remove file button
      document.getElementById('btn-remove-file').addEventListener('click', () => {
        resetFileState();
      });

      // Drag and drop handlers
      dropzone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.classList.add('border-neutral-900', 'bg-neutral-100');
      });

      dropzone.addEventListener('dragleave', (e) => {
        e.preventDefault();
        dropzone.classList.remove('border-neutral-900', 'bg-neutral-100');
      });

      dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropzone.classList.remove('border-neutral-900', 'bg-neutral-100');
        const file = e.dataTransfer.files[0];
        if (file && file.name.endsWith('.csv')) {
          processFile(file);
        } else {
          alert('CSV 파일만 업로드 가능합니다.');
        }
      });

      // Quick action buttons
      document.getElementById('btn-show-stats').addEventListener('click', showStatsModal);
      document.getElementById('btn-show-data').addEventListener('click', showDataModal);
      document.getElementById('btn-download-json-main').addEventListener('click', downloadJson);

      // Stats modal close
      document.getElementById('btn-close-stats-modal').addEventListener('click', () => {
        document.getElementById('stats-modal').classList.add('hidden');
      });
      document.getElementById('stats-modal').addEventListener('click', (e) => {
        if (e.target.id === 'stats-modal') {
          document.getElementById('stats-modal').classList.add('hidden');
        }
      });

      // Data modal close
      document.getElementById('btn-close-data-modal').addEventListener('click', () => {
        document.getElementById('data-modal').classList.add('hidden');
      });
      document.getElementById('data-modal').addEventListener('click', (e) => {
        if (e.target.id === 'data-modal') {
          document.getElementById('data-modal').classList.add('hidden');
        }
      });

      // Stats table sorting
      document.querySelectorAll('#stats-table th[data-sort]').forEach(th => {
        th.addEventListener('click', () => {
          const key = th.dataset.sort;
          if (statsSortKey === key) {
            statsSortAsc = !statsSortAsc;
          } else {
            statsSortKey = key;
            statsSortAsc = true;
          }
          renderStatsTableBody();
        });
      });

      // Type filter
      document.querySelectorAll('.type-filter').forEach(cb => {
        cb.addEventListener('change', (e) => {
          if (e.target.value === 'all') {
            statsTypeFilter = 'all';
            document.querySelectorAll('.type-filter').forEach(c => c.checked = c.value === 'all');
          } else {
            document.querySelector('.type-filter[value="all"]').checked = false;
            const checked = Array.from(document.querySelectorAll('.type-filter:checked')).map(c => c.value).filter(v => v !== 'all');
            statsTypeFilter = checked.length > 0 ? checked : 'all';
            if (statsTypeFilter === 'all') {
              document.querySelector('.type-filter[value="all"]').checked = true;
            }
          }
          renderStatsTableBody();
        });
      });

      // Data search
      document.getElementById('data-search').addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        if (query) {
          filteredData = allData.filter(row => {
            return Object.values(row).some(val =>
              String(val).toLowerCase().includes(query)
            );
          });
        } else {
          filteredData = allData;
        }
        currentPage = 1;
        renderTablePage();
      });
    }

    function resetFileState() {
      convertedJson = null;
      jsonData = null;
      currentFilename = '';
      document.getElementById('btn-show-stats').disabled = true;
      document.getElementById('btn-show-data').disabled = true;
      document.getElementById('btn-download-json-main').disabled = true;
      document.getElementById('file-input').value = '';
      document.getElementById('selected-file-text').textContent = '선택된 파일 없음';
      document.getElementById('btn-remove-file').classList.add('hidden');
    }

    async function processFile(file) {
      currentFilename = file.name;

      // Update selected file info immediately
      const fileSizeFormatted = formatBytes(file.size);
      document.getElementById('selected-file-text').textContent = `${file.name} (${fileSizeFormatted})`;
      document.getElementById('btn-remove-file').classList.remove('hidden');

      try {
        const content = await readFileContent(file);

        // Convert CSV to JSON using WASM (background)
        convertedJson = Module.convertToJson(content, file.name);
        jsonData = JSON.parse(convertedJson);

        // Enable buttons
        document.getElementById('btn-show-stats').disabled = false;
        document.getElementById('btn-show-data').disabled = false;
        document.getElementById('btn-download-json-main').disabled = false;

      } catch (error) {
        console.error('Error processing file:', error);
        alert('파일 처리 중 오류가 발생했습니다: ' + error.message);
        resetFileState();
      }
    }

    function downloadJson() {
      if (convertedJson) {
        const blob = new Blob([convertedJson], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = currentFilename.replace('.csv', '.json');
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }
    }

    function showStatsModal() {
      if (!jsonData) return;

      // Prepare stats data
      statsData = jsonData.schema.columns.map(col => {
        const colStats = jsonData.statistics.columns[col.name];
        return {
          name: col.name,
          type: colStats.type,
          min: colStats.type === 'integer' || colStats.type === 'float' ? colStats.min : (colStats.min_length || colStats.min || 0),
          max: colStats.type === 'integer' || colStats.type === 'float' ? colStats.max : (colStats.max_length || colStats.max || 0),
          mean: colStats.mean || 0,
          null_count: colStats.null_count,
          unique_count: colStats.unique_count,
          raw: colStats
        };
      });

      renderStatsTableBody();
      document.getElementById('stats-modal').classList.remove('hidden');
    }

    function renderStatsTableBody() {
      let data = [...statsData];

      // Apply type filter
      if (statsTypeFilter !== 'all') {
        const filters = Array.isArray(statsTypeFilter) ? statsTypeFilter : [statsTypeFilter];
        data = data.filter(d => filters.includes(d.type));
      }

      // Apply sorting
      if (statsSortKey) {
        data.sort((a, b) => {
          let va = a[statsSortKey];
          let vb = b[statsSortKey];
          if (typeof va === 'string') {
            va = va.toLowerCase();
            vb = vb.toLowerCase();
          }
          if (va < vb) return statsSortAsc ? -1 : 1;
          if (va > vb) return statsSortAsc ? 1 : -1;
          return 0;
        });
      }

      const tbody = document.getElementById('stats-table-body');
      tbody.innerHTML = data.map(d => {
        const typeLabel = {
          'integer': '정수',
          'float': '실수',
          'string': '문자열',
          'boolean': '불리언',
          'date': '날짜'
        }[d.type] || d.type;

        let minVal, maxVal, meanVal;
        if (d.type === 'integer' || d.type === 'float') {
          minVal = d.raw.min !== undefined ? d.raw.min.toLocaleString() : '-';
          maxVal = d.raw.max !== undefined ? d.raw.max.toLocaleString() : '-';
          meanVal = d.raw.mean !== undefined ? d.raw.mean.toFixed(2) : '-';
        } else if (d.type === 'string') {
          minVal = d.raw.min_length !== undefined ? `${d.raw.min_length}자` : '-';
          maxVal = d.raw.max_length !== undefined ? `${d.raw.max_length}자` : '-';
          meanVal = '-';
        } else {
          minVal = d.raw.min || '-';
          maxVal = d.raw.max || '-';
          meanVal = '-';
        }

        return `
          <tr class="border-b border-neutral-100 hover:bg-neutral-50">
            <td class="p-3 font-medium text-neutral-900">${d.name}</td>
            <td class="p-3">
              <span class="px-2 py-1 rounded text-xs font-medium bg-neutral-100 text-neutral-700">${typeLabel}</span>
            </td>
            <td class="p-3 text-right text-neutral-700">${minVal}</td>
            <td class="p-3 text-right text-neutral-700">${maxVal}</td>
            <td class="p-3 text-right text-neutral-700">${meanVal}</td>
            <td class="p-3 text-right text-neutral-700">${d.null_count}</td>
            <td class="p-3 text-right text-neutral-700">${d.unique_count}</td>
          </tr>
        `;
      }).join('');

      document.getElementById('stats-count').textContent = data.length;
    }

    function showDataModal() {
      if (!jsonData) return;

      allHeaders = jsonData.schema.columns.map(col => col.name);
      allData = jsonData.data;
      filteredData = allData;
      currentPage = 1;

      // Render table header
      const thead = document.getElementById('data-table-head');
      thead.innerHTML = `
        <tr>
          <th class="p-3 text-left font-semibold text-neutral-700 text-xs">#</th>
          ${allHeaders.map(h => `<th class="p-3 text-left font-semibold text-neutral-700 text-xs whitespace-nowrap">${h}</th>`).join('')}
        </tr>
      `;

      document.getElementById('data-search').value = '';
      renderTablePage();
      document.getElementById('data-modal').classList.remove('hidden');
    }

    function renderTablePage() {
      const tbody = document.getElementById('data-table-body');
      const totalRows = filteredData.length;
      const totalPages = Math.ceil(totalRows / pageSize);
      const start = (currentPage - 1) * pageSize;
      const end = Math.min(start + pageSize, totalRows);
      const pageData = filteredData.slice(start, end);

      document.getElementById('data-showing').textContent = pageData.length;
      document.getElementById('data-total').textContent = totalRows;

      tbody.innerHTML = pageData.map((row, idx) => `
        <tr class="border-b border-neutral-100 hover:bg-neutral-50">
          <td class="p-3 text-neutral-500 text-xs">${start + idx + 1}</td>
          ${allHeaders.map(h => {
            const val = row[h];
            const displayVal = val === null ? '<span class="text-neutral-400">null</span>' : val;
            return `<td class="p-3 text-neutral-700 text-xs whitespace-nowrap">${displayVal}</td>`;
          }).join('')}
        </tr>
      `).join('');

      renderPagination(totalPages);
    }

    function renderPagination(totalPages) {
      const container = document.getElementById('data-pagination');
      if (totalPages <= 1) {
        container.innerHTML = '';
        return;
      }

      let html = '';
      html += `<button onclick="goToPage(${currentPage - 1})"
        class="h-8 px-3 rounded text-sm ${currentPage === 1 ? 'text-neutral-300 cursor-not-allowed' : 'text-neutral-700 hover:bg-neutral-100'}"
        ${currentPage === 1 ? 'disabled' : ''}>이전</button>`;

      const maxVisible = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
      let endPage = Math.min(totalPages, startPage + maxVisible - 1);
      if (endPage - startPage < maxVisible - 1) {
        startPage = Math.max(1, endPage - maxVisible + 1);
      }

      if (startPage > 1) {
        html += `<button onclick="goToPage(1)" class="h-8 w-8 rounded text-sm text-neutral-700 hover:bg-neutral-100">1</button>`;
        if (startPage > 2) html += `<span class="text-neutral-400">...</span>`;
      }

      for (let i = startPage; i <= endPage; i++) {
        html += `<button onclick="goToPage(${i})"
          class="h-8 w-8 rounded text-sm ${i === currentPage ? 'bg-neutral-900 text-white' : 'text-neutral-700 hover:bg-neutral-100'}">${i}</button>`;
      }

      if (endPage < totalPages) {
        if (endPage < totalPages - 1) html += `<span class="text-neutral-400">...</span>`;
        html += `<button onclick="goToPage(${totalPages})" class="h-8 w-8 rounded text-sm text-neutral-700 hover:bg-neutral-100">${totalPages}</button>`;
      }

      html += `<button onclick="goToPage(${currentPage + 1})"
        class="h-8 px-3 rounded text-sm ${currentPage === totalPages ? 'text-neutral-300 cursor-not-allowed' : 'text-neutral-700 hover:bg-neutral-100'}"
        ${currentPage === totalPages ? 'disabled' : ''}>다음</button>`;

      container.innerHTML = html;
    }

    function goToPage(page) {
      const totalPages = Math.ceil(filteredData.length / pageSize);
      if (page < 1 || page > totalPages) return;
      currentPage = page;
      renderTablePage();
    }

    async function readFileContent(file) {
      // First, read as binary to detect encoding
      const arrayBuffer = await file.arrayBuffer();
      const uint8Array = new Uint8Array(arrayBuffer);

      // Detect encoding
      const encoding = detectEncoding(uint8Array);
      console.log('Detected encoding:', encoding);

      // Decode with detected encoding
      const decoder = new TextDecoder(encoding);
      const content = decoder.decode(uint8Array);

      return content;
    }

    function detectEncoding(uint8Array) {
      // Check for BOM (Byte Order Mark)
      if (uint8Array.length >= 3 &&
        uint8Array[0] === 0xEF &&
        uint8Array[1] === 0xBB &&
        uint8Array[2] === 0xBF) {
        return 'utf-8';
      }

      // Check for UTF-16 BOM
      if (uint8Array.length >= 2) {
        if (uint8Array[0] === 0xFE && uint8Array[1] === 0xFF) {
          return 'utf-16be';
        }
        if (uint8Array[0] === 0xFF && uint8Array[1] === 0xFE) {
          return 'utf-16le';
        }
      }

      // Heuristic detection for EUC-KR vs UTF-8
      let utf8Score = 0;
      let eucKrScore = 0;
      let i = 0;

      while (i < uint8Array.length && i < 10000) {
        const byte = uint8Array[i];

        // Check for valid UTF-8 sequences
        if (byte <= 0x7F) {
          // ASCII - valid in both
          i++;
          continue;
        }

        // UTF-8 multi-byte sequence detection
        if (byte >= 0xC2 && byte <= 0xDF && i + 1 < uint8Array.length) {
          // 2-byte UTF-8
          if (uint8Array[i + 1] >= 0x80 && uint8Array[i + 1] <= 0xBF) {
            utf8Score += 2;
            i += 2;
            continue;
          }
        }

        if (byte >= 0xE0 && byte <= 0xEF && i + 2 < uint8Array.length) {
          // 3-byte UTF-8 (Korean characters are typically here)
          const byte2 = uint8Array[i + 1];
          const byte3 = uint8Array[i + 2];
          if (byte2 >= 0x80 && byte2 <= 0xBF && byte3 >= 0x80 && byte3 <= 0xBF) {
            // Check for Korean Unicode range (AC00-D7AF = 가-힣)
            if (byte === 0xEA || byte === 0xEB || byte === 0xEC || byte === 0xED) {
              utf8Score += 5;
            } else {
              utf8Score += 3;
            }
            i += 3;
            continue;
          }
        }

        // EUC-KR detection (Korean characters: 0xB0A1-0xC8FE)
        if (byte >= 0xB0 && byte <= 0xC8 && i + 1 < uint8Array.length) {
          const nextByte = uint8Array[i + 1];
          if (nextByte >= 0xA1 && nextByte <= 0xFE) {
            eucKrScore += 3;
            i += 2;
            continue;
          }
        }

        // Extended EUC-KR / CP949 detection (0x81-0xFE)
        if (byte >= 0x81 && byte <= 0xFE && i + 1 < uint8Array.length) {
          const nextByte = uint8Array[i + 1];
          if ((nextByte >= 0x41 && nextByte <= 0x5A) ||
            (nextByte >= 0x61 && nextByte <= 0x7A) ||
            (nextByte >= 0x81 && nextByte <= 0xFE)) {
            eucKrScore += 2;
            i += 2;
            continue;
          }
        }

        i++;
      }

      console.log('Encoding scores - UTF-8:', utf8Score, 'EUC-KR:', eucKrScore);

      // If EUC-KR score is significantly higher, use EUC-KR
      if (eucKrScore > utf8Score * 1.5 && eucKrScore > 10) {
        return 'euc-kr';
      }

      // Default to UTF-8
      return 'utf-8';
    }

    function formatBytes(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // For files that might be in EUC-KR encoding
    async function readFileWithEncoding(file, encoding) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (e) => resolve(e.target.result);
        reader.onerror = () => reject(new Error('파일을 읽을 수 없습니다.'));
        reader.readAsText(file, encoding);
      });
    }
  </script>
</body>

</html>